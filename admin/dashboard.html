<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ§åˆ¶å° - å˜‰å­šå ‚åå°ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="admin-wrapper">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="../images/logo.png" alt="å˜‰å­šå ‚">
                <h2>åå°ç®¡ç†</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="nav-item active">
                    <span>ğŸ“Š</span> <span>æ§åˆ¶å°</span>
                </a>
                <a href="pages/collections.html" class="nav-item">
                    <span>ğŸ¨</span> <span>è—å“ç®¡ç†</span>
                </a>
                <a href="pages/news.html" class="nav-item">
                    <span>ğŸ“°</span> <span>æ–°é—»ç®¡ç†</span>
                </a>
                <a href="pages/submissions.html" class="nav-item">
                    <span>ğŸ“‹</span> <span>æäº¤è®°å½•</span>
                </a>
                <a href="#" onclick="logout(); return false;" class="nav-item">
                    <span>ğŸšª</span> <span>é€€å‡ºç™»å½•</span>
                </a>
            </nav>
        </aside>

        <!-- ä¸»å†…å®¹ -->
        <main class="main-content">
            <div class="page-header">
                <h1>æ§åˆ¶å°</h1>
                <div class="user-info">
                    <span>æ¬¢è¿ï¼Œ<strong id="currentUser">admin</strong></span>
                    <button class="btn-logout" onclick="logout()">é€€å‡º</button>
                </div>
            </div>

            <!-- ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>è—å“æ€»æ•°</h3>
                    <div class="number" id="totalCollections">0</div>
                </div>
                <div class="stat-card">
                    <h3>æ–°é—»æ€»æ•°</h3>
                    <div class="number" id="totalNews">0</div>
                </div>
                <div class="stat-card">
                    <h3>æäº¤è®°å½•</h3>
                    <div class="number" id="totalSubmissions">0</div>
                </div>
                <div class="stat-card">
                    <h3>å·²æ‹å–è—å“</h3>
                    <div class="number" id="soldCollections">0</div>
                </div>
            </div>

            <!-- æœ€è¿‘æäº¤ -->
            <div class="data-table-container">
                <div class="table-toolbar">
                    <h3>æœ€è¿‘æäº¤çš„è—å“</h3>
                    <a href="pages/submissions.html" class="btn-sm btn-view">æŸ¥çœ‹å…¨éƒ¨</a>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>è—å“åç§°</th>
                            <th>å“ç±»</th>
                            <th>è”ç³»äºº</th>
                            <th>è”ç³»æ–¹å¼</th>
                            <th>æäº¤æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody id="recentSubmissions">
                        <tr>
                            <td colspan="5" class="empty-state">æš‚æ— æäº¤è®°å½•</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="js/auth.js"></script>
    <script>
        // æ£€æŸ¥ç™»å½•
        checkAuth();
        
        // æ˜¾ç¤ºå½“å‰ç”¨æˆ·
        document.getElementById('currentUser').textContent = getCurrentUser();
        
        // é»˜è®¤æ•°æ®
        const defaultCollections = [
            // å¤è‘£æ–‡ç‰© (4ä»¶)
            {id: 1, title: 'æ¸…ä»£ç´«æª€æœ¨é›•ç¦ç¦„å¯¿å±é£', category: 'antique', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=600', summary: 'æ¸…ä»£æ™šæœŸç´«æª€æœ¨é›•', isFeatured: true},
            {id: 2, title: 'æ°‘å›½ç²‰å½©äººç‰©æ•…äº‹ç“¶', category: 'antique', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1565193566173-7a0ee3dbe261?w=600', summary: 'æ°‘å›½ç²‰å½©åå“', isFeatured: true},
            {id: 3, title: 'æ˜å¼é»„èŠ±æ¢¨å®˜å¸½æ¤…', category: 'antique', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1506439773649-6e0eb8cfb237?w=600', summary: 'æ˜å¼å®¶å…·ç»å…¸', isFeatured: false},
            {id: 4, title: 'å®‹ä»£å»ºçª‘å…”æ¯«ç›', category: 'antique', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600', summary: 'å®‹ä»£å»ºçª‘', isFeatured: false},
            // è‰ºæœ¯å“ (4ä»¶)
            {id: 5, title: 'é½ç™½çŸ³ã€Šè™¾è¶£å›¾ã€‹', category: 'art', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1578926288207-a90a5366759d?w=600', summary: 'é½ç™½çŸ³ç²¾å“', isFeatured: true},
            {id: 6, title: 'å¼ å¤§åƒã€Šå±±æ°´å››æ¡å±ã€‹', category: 'art', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1605883705077-8d3d3cebe78c?w=600', summary: 'å¼ å¤§åƒå±±æ°´', isFeatured: true},
            {id: 7, title: 'å‚…æŠ±çŸ³ã€Šå±±æ°´é•¿å·ã€‹', category: 'art', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1600636567129-674c947c29b7?w=600', summary: 'å‚…æŠ±çŸ³åŠ›ä½œ', isFeatured: false},
            {id: 8, title: 'å¾æ‚²é¸¿ã€Šå¥”é©¬å›¾ã€‹', category: 'art', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1518998053901-5348d3961a04?w=600', summary: 'å¾æ‚²é¸¿ä»£è¡¨ä½œ', isFeatured: false},
            // ç å®å¥¢ä¾ˆå“ (4ä»¶)
            {id: 9, title: 'å¡åœ°äºšé’»çŸ³èƒ¸é’ˆ', category: 'jewelry', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?w=600', summary: 'å¡åœ°äºšç»å…¸', isFeatured: true},
            {id: 10, title: 'ç¿¡ç¿ æ‰‹é•¯ ç»ç’ƒç§', category: 'jewelry', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1602751584552-8ba73aad10e1?w=600', summary: 'ç»ç’ƒç§ç¿¡ç¿ ', isFeatured: true},
            {id: 11, title: 'æ¢µå…‹é›…å®é’»çŸ³é¡¹é“¾', category: 'jewelry', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=600', summary: 'æ¢µå…‹é›…å®', isFeatured: false},
            {id: 12, title: 'çº¢å®çŸ³æˆ’æŒ‡', category: 'jewelry', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1605100804763-247f67b3557e?w=600', summary: 'é¸½è¡€çº¢å®çŸ³', isFeatured: false},
            // æ–‡çŒ®é‚®å¸ (4ä»¶)
            {id: 13, title: 'ç¬¬ä¸€ç‰ˆäººæ°‘å¸å…¨å¥—', category: 'coin', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1621155346337-1d19476ba7d6?w=600', summary: 'ç¬¬ä¸€ç‰ˆäººæ°‘å¸', isFeatured: true},
            {id: 14, title: 'æ–‡é©æ—¶æœŸçé‚®ç¥¨', category: 'coin', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1580196929935-77f7a7a8e389?w=600', summary: 'æ–‡é©é‚®ç¥¨', isFeatured: false},
            {id: 15, title: 'è¢å¤§å¤´é“¶å…ƒ', category: 'coin', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1610375461246-83df859d849d?w=600', summary: 'è¢å¤§å¤´', isFeatured: false},
            {id: 16, title: 'å¤é’±å¸ä¸€ç»„', category: 'coin', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1571752726703-5e7d1f6a986d?w=600', summary: 'å¤é’±å¸', isFeatured: false},
            // æ•°å­—è—å“ (4ä»¶)
            {id: 17, title: 'NFTã€Šåˆ›ä¸–ä¹‹å¢ƒã€‹', category: 'nft', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1642104704074-907c0698cbd9?w=600', summary: 'æ•°å­—è‰ºæœ¯å“', isFeatured: true},
            {id: 18, title: 'NFTã€Šæ˜Ÿé™…å¹»æƒ³ã€‹', category: 'nft', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?w=600', summary: 'é™é‡ç‰ˆNFT', isFeatured: false},
            {id: 19, title: 'NFTã€Šèµ›åšæœ‹å…‹ã€‹', category: 'nft', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1634152962476-4b8a00e1915c?w=600', summary: 'èµ›åšæœ‹å…‹', isFeatured: false},
            {id: 20, title: 'NFTã€ŠæŠ½è±¡è‰ºæœ¯ã€‹', category: 'nft', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1618005198919-d3d4b5a92ead?w=600', summary: 'æŠ½è±¡NFT', isFeatured: false},
            // æ‚é¡¹ (4ä»¶)
            {id: 21, title: '19ä¸–çºªè¥¿æ´‹åº§é’Ÿ', category: 'misc', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1508057198894-247b23fe5ade?w=600', summary: 'è¥¿æ´‹åº§é’Ÿ', isFeatured: false},
            {id: 22, title: 'åŠ³åŠ›å£«æ‰‹è¡¨', category: 'misc', status: 'sold', coverImage: 'https://images.unsplash.com/photo-1523170335258-f5ed11844a49?w=600', summary: 'åŠ³åŠ›å£«', isFeatured: true},
            {id: 23, title: 'ç´«ç ‚å£¶ åå®¶æ¬¾', category: 'misc', status: 'unsold', coverImage: 'https://images.unsplash.com/photo-1565193566173-7a0ee3dbe261?w=600', summary: 'ç´«ç ‚å£¶', isFeatured: false},
            {id: 24, title: 'æ²‰é¦™æ‰‹ä¸²', category: 'misc', status: 'coming', coverImage: 'https://images.unsplash.com/photo-1611085583191-a3b181a88401?w=600', summary: 'æ²‰é¦™', isFeatured: false}
        ];
        
        const defaultNews = [
            {id: 1, title: '2026å¹´æ˜¥å­£è‰ºæœ¯å“æ‹å–ä¼šåœ†æ»¡è½å¹•', category: 'brand', coverImage: 'https://images.unsplash.com/photo-1518998053901-5348d3961a04?w=600', summary: 'æœ¬æ¬¡æ‹å–ä¼šæˆäº¤æ€»é¢çªç ´5äº¿å…ƒ', publishAt: '2026-02-15', isTop: true},
            {id: 2, title: 'æ”¶è—å¸‚åœºæŒç»­å‡æ¸© ä¸“å®¶è§£è¯»æŠ•èµ„è¶‹åŠ¿', category: 'industry', coverImage: 'https://images.unsplash.com/photo-1578926288207-a90a5366759d?w=600', summary: 'è‰ºæœ¯å“æ”¶è—å¸‚åœºæŒç»­å‡æ¸©', publishAt: '2026-02-12', isTop: false},
            {id: 3, title: 'å˜‰å­šå ‚æ­£å¼å¼€é€šçº¿ä¸Šè—å“å¾é›†æœåŠ¡', category: 'brand', coverImage: 'https://images.unsplash.com/photo-1621155346337-1d19476ba7d6?w=600', summary: 'å¼€é€šçº¿ä¸Šè—å“å¾é›†æœåŠ¡', publishAt: '2026-02-05', isTop: false}
        ];
        
        // åˆå§‹åŒ–æ•°æ®ï¼ˆå¦‚æœlocalStorageä¸ºç©ºï¼‰
        if (!localStorage.getItem('jiafu_collections')) {
            localStorage.setItem('jiafu_collections', JSON.stringify(defaultCollections));
        }
        if (!localStorage.getItem('jiafu_news')) {
            localStorage.setItem('jiafu_news', JSON.stringify(defaultNews));
        }
        if (!localStorage.getItem('jiafu_submissions')) {
            localStorage.setItem('jiafu_submissions', JSON.stringify([]));
        }
        
        // åŠ è½½ç»Ÿè®¡æ•°æ®
        function loadStats() {
            const collections = JSON.parse(localStorage.getItem('jiafu_collections') || '[]');
            const news = JSON.parse(localStorage.getItem('jiafu_news') || '[]');
            const submissions = JSON.parse(localStorage.getItem('jiafu_submissions') || '[]');
            
            document.getElementById('totalCollections').textContent = collections.length;
            document.getElementById('totalNews').textContent = news.length;
            document.getElementById('totalSubmissions').textContent = submissions.length;
            document.getElementById('soldCollections').textContent = collections.filter(c => c.status === 'sold').length;
            
            // æ˜¾ç¤ºæœ€è¿‘æäº¤
            const tbody = document.getElementById('recentSubmissions');
            if (submissions.length > 0) {
                const recent = submissions.slice(-5).reverse();
                tbody.innerHTML = recent.map(s => `
                    <tr>
                        <td>${s.itemName || '-'}</td>
                        <td>${getCategoryName(s.itemCategory)}</td>
                        <td>${s.contactName || '-'}</td>
                        <td>${s.contactMobile || s.contactWechat || '-'}</td>
                        <td>${formatDate(s.createdAt)}</td>
                    </tr>
                `).join('');
            }
        }
        
        function getCategoryName(category) {
            const categories = {
                'art': 'è‰ºæœ¯å“',
                'antique': 'å¤è‘£æ–‡ç‰©',
                'jewelry': 'ç å®å¥¢ä¾ˆå“',
                'coin': 'æ–‡çŒ®é‚®å¸',
                'nft': 'æ•°å­—è—å“',
                'misc': 'æ‚é¡¹'
            };
            return categories[category] || category;
        }
        
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleDateString('zh-CN');
        }
        
        loadStats();
    </script>
</body>
</html>
